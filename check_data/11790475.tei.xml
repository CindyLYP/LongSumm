<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /Users/cindy/tmp/grobid-0.6.1/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">A Meta-Transfer Objective for Learning to Disentangle Causal Mechanisms</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2019-02-04">4 Feb 2019</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Yoshua</forename><surname>Bengio</surname></persName>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Tristan</forename><surname>Deleu</surname></persName>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Nasim</forename><surname>Rahaman</surname></persName>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Nan</forename><forename type="middle">Rosemary</forename><surname>Ke</surname></persName>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Sébastien</forename><surname>Lachapelle</surname></persName>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Olexa</forename><surname>Bilaniuk</surname></persName>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Anirudh</forename><surname>Goyal</surname></persName>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Christopher</forename><surname>Pal</surname></persName>
						</author>
						<author>
							<affiliation key="aff0">
								<orgName type="institution">Université de Montréal</orgName>
								<address>
									<settlement>Mila, Montréal</settlement>
									<region>Québec</region>
									<country key="CA">Canada</country>
								</address>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff1">
								<orgName type="laboratory">3É cole Polytechnique Montréal Ruprecht-Karls-Universität Heidelberg Canada CIFAR AI Chair</orgName>
							</affiliation>
						</author>
						<title level="a" type="main">A Meta-Transfer Objective for Learning to Disentangle Causal Mechanisms</title>
					</analytic>
					<monogr>
						<imprint>
							<date type="published" when="2019-02-04">4 Feb 2019</date>
						</imprint>
					</monogr>
					<idno type="arXiv">arXiv:1901.10912v2[cs.LG]</idno>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.6.1" ident="GROBID" when="2021-01-31T12:45+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<abstract>
				<p>We propose to meta-learn causal structures based on how fast a learner adapts to new distributions arising from sparse distributional changes, e.g. due to interventions, actions of agents and other sources of non-stationarities. We show that under this assumption, the correct causal structural choices lead to faster adaptation to modified distributions because the changes are concentrated in one or just a few mechanisms when the learned knowledge is modularized appropriately. This leads to sparse expected gradients and a lower effective number of degrees of freedom needing to be relearned while adapting to the change. It motivates using the speed of adaptation to a modified distribution as a meta-learning objective. We demonstrate how this can be used to determine the cause-effect relationship between two observed variables. The distributional changes do not need to correspond to standard interventions (clamping a variable), and the learner has no direct knowledge of these interventions. We show that causal structures can be parameterized via continuous variables and learned end-to-end. We then explore how these ideas could be used to also learn an encoder that would map low-level observed variables to unobserved causal variables leading to faster adaptation out-of-distribution, learning a representation space where one can satisfy the assumptions of independent mechanisms and of small and sparse changes in these mechanisms due to actions and non-stationarities.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.">Introduction</head><p>Current machine learning methods seem weak when they are required to generalize beyond the training distribution, which is what is often needed in practice. It is not enough to obtain good generalization on a test set sampled from the same distribution as the training data, we would also like what has been learned in one setting to generalize well in other related distributions. These distributions may involve the same concepts that were seen previously by the learner, with the changes typically arising because of actions of agents. More generally, we would like what has been learned previously to form a rich base from which very fast adaptation to a new but related distribution can take place, i.e., obtain good transfer. Some new concept may have to be learned but because most of the other relevant concepts have already been captured by the learner (as well as how they can be composed), learning can be very fast on the transfer distribution.</p><p>Short of any assumption, it is impossible to have a successful transfer to an unrelated distribution. In this paper we focus on the assumption that the changes are sparse when the knowledge is represented in an appropriately modularized way, with only one or a few of the modules having changed. This is especially relevant when the distributional change is due to actions by one or more agents, such as the interventions discussed in the causality literature <ref type="bibr" target="#b20">(Pearl, 2009;</ref><ref type="bibr" target="#b21">Peters et al., 2017)</ref>, where a single causal variable is clamped to a particular value. In general, it is difficult for agents to influence many underlying causal variables at a time, and although this paper is not about agent learning as such, this is a property of the world that we propose to exploit here, to help discovering these variables and how they are causally related to each other.</p><p>To motivate the need for inferring causal structure, consider that interventions may be actually performed or may be imagined. In order to properly plan in a way that takes into account interventions, one needs to imagine a possible change to the joint distribution of the variables of interest due to an intervention, even one that has never been observed before. This goes beyond good transfer learning and requires causal learning and causal reasoning. For this purpose, it is not sufficient to learn the joint distribution of the observed variables. One also should learn enough about the underlying high-level variables and their causal relations to be able to properly infer the effect of an intervention. For example, A=Raining causes B=Open Umbrella <ref type="bibr">(and not vice-versa)</ref>. Changing the marginal probability of Raining (say because the weather changed) does not change the mechanism that relates A and B (captured by P (B|A)), but will have an impact on the marginal P (B). Conversely, an agent's intervention on B (Open umbrella) will have no effect on the marginal distribution of A (Raining). That asymmetry is generally not visible from the (A, B) training pairs alone, until a change of distribution occurs, e.g. due to an intervention. This motivates the setup of this paper, where one learns from a set of distributions arising from not necessarily known interventions, not simply to capture a joint distribution but to discover the some underlying causal structure.</p><p>Machine learning methods are often exploiting some form of assumption about the data distribution (or else, the no free lunch theorem tells us that we cannot have any confidence in generalization). In this paper, we are considering not just assumptions on the data distribution but also on how it changes (e.g., when going from a training distribution to a transfer distribution, possibly resulting from some agent's actions). We propose to rely on the assumption that, when the knowledge about the distribution is appropriately represented, these changes would be small. This arises because of an underlying assumption (but more difficult to verify directly) that only one or few of the ground truth mechanisms have been changed, due to some generalized form of intervention leading to the modified distribution.</p><p>How can we exploit this assumption? As we explain theoretically and verify experimentally here, if we have the right knowledge representation, then we should get fast adaptation to the transfer distribution when starting from a model that is well trained on the training distribution. This arises because of our assumption that the ground truth data generative process is obtained as the composition of independent mechanisms and that, very few ground truth mechanisms and parameters need to change when going from the training distribution to the transfer distribution. A model capturing a corresponding factorization of knowledge would thus require just a few updates, a few examples, for this adaptation to the transfer distribution. As shown below, the expected gradient on the unchanged parameters would be near 0 (if the model was already well trained on the training distribution), so the effective search space during adaptation to the transfer distribution would be greatly reduced, which tends to produce fast adaptation, as found experimentally.</p><p>Thus, based on the assumption of small change in the right knowledge representation space, we can define a meta-learning objective that measures the speed of adaptation, i.e., a form of regret, in order to optimize the way in which knowledge should be represented, factorized and structured. This is the core idea presented in this paper. Note that a stronger signal can be obtained when there are more non-stationarities, i.e., many changes in distribution, just like in meta-learning we get better results with more meta-examples.</p><p>In this way, we can take what is normally considered a nuisance in machine learning (changes in distribution due to non-stationarity, uncontrolled interventions, etc.) and turn that into a training signal to find a good way to factorize knowledge into components and mechanisms that match the assumption of small change. Thus, we end up optimizing in an end-to-end way the very thing we care about at the end, i.e. fast transfer and robustness to distributional changes. If the data was really generated from the composition of independent causal mechanisms <ref type="bibr" target="#b21">(Peters et al., 2017)</ref>, then there exists a good factorization of knowledge that mimics that structure. If in addition, at each time step, agents in the real world tend to only be able to change one or very few high-level variables (or the associated mechanisms producing them), then our assumption of small change (in the right representation) should be generally valid. Also, in addition to obtaining fast transfer, we may be able to recover a good approximation of the true causal decomposition into independent mechanisms (to the extent that the observations and interventions can reveal those mechanisms).</p><p>In this paper, we begin exploring the above ideas with specific experiments on synthetically generated data in order to validate them and demonstrate the existence of simple algorithms to exploit them. However it is clear to us that much more work will be needed to evaluate the proposed approach in a diversity of settings and with different specific parametrizations, training objectives, environments, etc. We begin with what are maybe the simplest possible settings and evaluate whether the above approach can be used to learn the direction of causality. We then study the crucial question of obtaining a training signal about how to transform raw observed data into a representation space where the latent variables can be modeled by a sparse causal graph with sparse distributional changes and show results that confirm that the correct encoder leads to a better value of our expected regret meta-learning objective.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.">Which is Cause and Which is Effect?</head><p>To anchor ideas and show an example of application of the above-proposed meta-objective for knowledge decomposition, we consider in this section the problem of determining if variable A causes variable B or vice-versa. The learner observes training samples (a, b) from a pair of related distributions, which by convention we call the training distribution and the transfer distribution. Note that based only on samples from a single (training) distribution, in general both the A → B model (A causes B) and the B → A model (vice-versa, see Equation <ref type="formula" target="#formula_0">1</ref>below) tend to perform as well in terms of ordinary generalization (to a test set sampled from the training distribution), see also a theoretical argument and simulation results in Appendix A. To highlight the power of the proposed meta-learning objective, we consider the situation where lots of examples are available for the training distribution but very few for the transfer distribution. In fact, as we will argue below, the training signal that will allow us to infer the correct causal direction will be stronger if we have access to many short transfer adaptation episodes. Short episodes are most informative because after having seen a lot of data from the transfer distribution, it will not matter much whether A causes B or vice-versa (when there is enough training data compared to the number of free parameters, both models converge towards an optimal estimation of the joint). However, in order to generalize quickly from very few examples of the transfer distribution, it does matter to have made the correct choice of the causal direction. Let us now justify this in more detail below and then demonstrate this by simulations.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Learning a Causal Graph with two Discrete Variables</head><p>Let both A and B be discrete variables each taking N possible values and consider the following two parametrizations (the A → B model and the B → A model) to estimate their joint distribution:</p><formula xml:id="formula_0">P A→B (A, B) = P A→B (A)P A→B (B | A) P B→A (A, B) = P B→A (B)P B→A (A | B)<label>(1)</label></formula><p>Each of these two graphical models (denoted A → B and B → A) decomposes the joint into two separately parametrized modules, each corresponding to a different causal mechanism associated with the probability of a variable given its parents in the graph. This amounts to four modules: P A→B (A), P A→B (B | A), P B→A (B) and P B→A (A | B). We will train both models independently. Since we assume in this section that the pairs (A, B) are completely observed, we can use a simple maximum likelihood estimator to independently train all four modules (the log-likelihood of the joint decomposes into separate objective functions, one for each conditional, in a directed graphical model with fully observed variables). In the discrete case with tabular parametrization, the maximum likelihood estimator can be computed analytically, and corresponds to the appropriately normalized relative frequencies. Let θ denote the parameters of all these models, split into sub-vectors for each module, e.g., θ A|B for the N 2 conditional probabilities for each possible value of B and each possible value of A. In our experiments, we parametrized these probabilities via softmax of unnormalized quantities.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1.1">The Advantage of the Correct Causal Model</head><p>First, let us consider simply the likelihood of the training data only (i.e., no change of distribution) for the different causal models considered. Both models have O(N 2 ) parameters, and maximum likelihood estimation leads to indistinguishable test set performance (where the test set is sampled from the training distribution). See Appendix A for a demonstration that both models would have the same likelihood, and associated experimental results. These results are not surprising in light of the existing literature on non-identifiability of causality from observations <ref type="bibr" target="#b20">(Pearl, 2009;</ref><ref type="bibr" target="#b21">Peters et al., 2017)</ref>, but they highlight the importance of using changes in distribution to provide a signal about the causal structure. Now instead let us compare the performance of our two hypotheses (A → B vs B → A) in terms of how fast the two models adapt on a transfer distribution after having been trained on the training distribution. We will assume simple stochastic gradient descent on the parameters for this adaptation but other procedures could be used, of course. Without loss of generality, let A → B be the correct causal model. To make the case stronger, let us consider that the change between the two distributions amounts to a random change in the parameters of the true P (A) for the cause A (because this will have an impact on the effect B, which can be picked up and reveal the causal direction). We do not assume that the learner knows what intervention was performed, unlike in more common approaches to causal discovery and controlled experiments. We only assume that some change happened and we try to exploit that to reveal structural causal information. Here the model is discrete, with N = 10. Curves are the median over 10 000 runs, with 25-75% quantiles intervals, for both the correct causal model (blue, top) and the incorrect one (red, bottom). We see that the correct causal model adapts faster (smaller regret), and that the most informative part of the trajectory (where the two models generalize the most differently) is in the first 10-20 examples.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Experiments on Adaptation to the transfer distribution</head><p>We present experiments comparing the learning curve of the correct causal model on the transfer distribution vs the learning curve of the incorrect model. The adaptation with only a few gradient steps on data coming from a different, but related, transfer distribution is critical in getting a signal that can be leveraged by our meta-learning algorithm. To show the effect of this adaptation, and motivate our use of only a small amount of data from the transfer distribution, we experimented with a model on discrete random variables taking N = 10 possible values. In this experiment, we fixed the underlying causal model to be A → B, and trained the modules for each marginal and conditional distributions with maximum likelihood on a large amount of data from some training distribution, as explained in Appendix A. See also Appendix G.1 and <ref type="table">Table G</ref>.1 for details on the definitions of these modules.</p><p>We then adapt all the modules on data coming from a transfer distribution, corresponding on an intervention on the random variable A (i.e., the marginal P (A) of the ground truth model is modified, while leaving P (B | A) fixed). We used RMSprop for the adaptation, with the same learning rate. For assessing reproducibility and statistical robustness, the experiment was repeated over 100 different training distributions, and over 100 transfer distributions for each training distributions, leading to 10 000 experiments overall. The procedure to acquire different training/transfer distributions is detailed in Appendix G.1.</p><p>In <ref type="figure" target="#fig_0">Figure 1</ref>, we report the log-likelihoods of both models, evaluated on a large test set of 10 000 from the transfer distribution. We can see that as the number of examples from the transfer distribution (equal to the number of adaptation steps) increases, the two models eventually reach the same log-likelihood, reflecting our observation from Appendix A. However the causal model A → B adapts faster than the other model B → A, with the most informative part of the trajectory (where the difference is the largest) is within the first 10 to 20 examples.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2.1">Parameter Counting Argument</head><p>A simple parameter counting arguments helps us understand what we are observing in <ref type="figure" target="#fig_0">Figure 1</ref>. First, consider the expected gradient on the parameters of the different modules, during the adaptation phase to the transfer distribution, which we designate as adaptation episode, and corresponds to learning from a meta-example.</p><p>Proposition 1 The expected gradient over the transfer distribution of the regret (accumulated negative log-likelihood during the adaptation episode) with respect to the module parameters is zero for the parameters of the modules that (a) were correctly learned in the training phase, and (b) have the correct set of causal parents, corresponding to the ground truth causal graph, if (c) the corresponding ground truth conditional distributions did not change from the training distribution to the transfer distribution.</p><p>The proof is given in Appendix B. The basic justification for this proposition is that for the modules that were correctly learned in the training distribution and whose ground truth conditional distribution did not change with the transfer distribution, the parameters already are at a maximum of the log-likelihood over the transfer distribution, so the expected gradient is zero.</p><p>As a consequence, the effective number of parameters that need to be adapted, when one has the correct causal graph structure, is reduced to those of the mechanisms that actually changed from the training to the transfer distribution. Since sample complexity -the number of training examples necessary to learn a model -grows approximately linearly <ref type="bibr" target="#b6">(Ehrenfeucht et al., 1989)</ref> with VC-dimension <ref type="bibr" target="#b26">(Vapnik and Chervonenkis, 1971)</ref>, and since VC-dimension grows approximately linearly in the number of parameters in linear models and neural networks Shalev-Shwartz and Ben-David (2014), the learning curve on the transfer distribution will tend to improve faster for the model with the correct causal structure, for which fewer parameters need to be changed. Interestingly, we do not need to have the whole causal graph correctly specified before getting benefits from this phenomenon. If we only have part of the causal graph correctly specified and we change our causal hypothesis to include one more correctly specified mechanism, then we will obtain a gain in terms of the adaptation sample complexity (which shows up when the change in distribution does not touch that mechanism). This nice property also shows up in Proposition 4 (Appendix F), showing a decoupling of the meta-objective across the independent mechanisms.</p><p>Let us consider the special case we have been studying up to now. We have four modules, two of which (P A→B (A) and P B→A (B)) are marginal discrete distributions over N values, which require each N − 1 free parameters. The other two modules are conditional probability tables that have N rows each with N − 1 free parameters, i.e., a total of N (N − 1) free parameters. If A → B is the correct model and the transfer distribution only changed the true P (A) (the cause), and if P (B | A) had been correctly estimated on the training distribution, then for the correct model only N − parameters need to be re-estimated. On the other hand, because of Bayes' rule, under the incorrect model (B → A), a change in P (A) leads to new parameters for both P (B) and P (A | B), i.e., all N (N − 1) + (N − 1) = N 2 − 1 parameters must be re-estimated. In this case we see that sample complexity may be O(N 2 ) for the incorrect model while it would be O(N ) for the correct model (assuming linear relationship between sample complexity and number of free parameters). Of course, if the change in distribution had been over P (B | A) instead of P (A), the advantage would not have been as great. This would motivate information gathering actions generally resulting in a very sparse change in the mechanisms.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">Smooth parameterization of the causal structure</head><p>In the more general case with many more than two hypotheses for the structure of the causal graph, there will be an exponentially large set of possible causal structures explaining the data and we won't be able to enumerate all of them (and pick the best one after observing episodes of adaptation). However, we can parameterize our belief about an exponentially large set of hypotheses by keeping track of the probability for each directed edge of the graph to be present, i.e., specify for each variable B whether some variable A is a direct causal parent of B (for all pairs (A, B) in the graph). We will develop such a smooth parametrization further in Appendix F, but it hinges on gradually changing our belief in the individual binary decisions associated with each edge of the causal graph, so we can jointly do gradient descent on all these beliefs at the same time.</p><p>In this section, we study the simplest possible version of this idea, representing that edge belief via a structural parameter γ with sigmoid(γ) = sigmoid(γ), our believed probability that A → B is the correct choice. For that single pair of variables scenario, let us consider two explanations for the data (as in the above sections, for models A → B and B → A), one with probability p(A → B) = sigmoid(γ) and the other with probability p(B → A) = 1 − sigmoid(γ). We can write down our transfer objective as a log-likelihood over the mixture of these two models. Note this is different from the usual mixture models, which assume separately for each example that it was sampled from one component or another with some probability. Here, we assume that all of the observed data was sampled from one component or the other. The transfer data regret (negative log-likelihood accumulated along the online adaptation trajectory) under that mixture is therefore as follows:</p><formula xml:id="formula_1">R = − log [sigmoid(γ)L A→B + (1 − sigmoid(γ))L B→A ]<label>(2)</label></formula><p>where L A→B and L B→A are the online likelihoods of both models respectively on the transfer data. They are defined as</p><formula xml:id="formula_2">L A→B = T t=1 P A→B (a t , b t ; θ t ) L B→A = T t=1 P B→A (a t , b t ; θ t ),</formula><p>where {(a t , b t )} t is the set of transfer examples for a given episode and θ t aggregates all the modules' parameters as of time step t (since the parameters could be updated after each observation of an example (a t , b t ) from the transfer distribution). P model (a, b; θ) is the likelihood of example (a, b) under some model that has parameters θ. The quantity of interest here is ∂R ∂γ , which is our training signal for updating γ. In the experiments below, after each episode involving T transfer examples we update γ by doing one step of gradient descent, to reduce the transfer negative log-likelihood or regret R. What we are proposing is a meta-learning framework in which the inner training loop updates the module parameters (separately) as examples are seen (from either distribution being currently observed), while the outer loop updates the structural parameters (here it is only the scalar γ) with respect to the transfer negative log-likelihood.</p><p>The gradient of the transfer log-likelihood with respect to the structural parameter γ is pushing sigmoid(γ) towards the posterior probability that the correct model is A → B and (1 − sigmoid(γ)) towards the posterior probability that the correct model is B → A:</p><p>Proposition 2 The gradient of the negative log-likelihood of the transfer data in Equation (2) wrt. the structural parameter ∂R ∂γ is given by</p><formula xml:id="formula_3">∂R ∂γ = σ(γ) − P (A → B | D 2 ),<label>(3)</label></formula><p>where D 2 is the transfer data, and</p><formula xml:id="formula_4">P (A → B | D 2 )</formula><p>is the posterior probability of the hypothesis A → B (when the alternative is B → A). Furthermore, this can be equivalently written as</p><formula xml:id="formula_5">∂R ∂γ = σ(γ) − σ(γ + ∆),<label>(4)</label></formula><p>where ∆ = log L A→B − log L B→A is the difference between the log-likelihoods of the two hypotheses on the transfer data D 2 .</p><p>The proof is given in Appendix D. Note how this posterior probability is basically measuring which hypothesis is better explaining the episode transfer data D 2 overall along the adaptation trajectory. D 2 is a metaexample for updating the structural parameters like γ. Larger ∆ of one hypothesis over the other leads to moving meta-parameters faster towards the favoured hypothesis. This difference in online accumulated log-likelihoods ∆ also relates to log-likelihood scores in score-based methods for structure learning of graphical models <ref type="bibr" target="#b14">(Koller and Friedman, 2009)</ref> 1 . To find where SGD converges, note that the actual posterior depends on the prior sigmoid(γ) and thus keeps changing after each gradient step. We are really doing SGD on the expected value of R over transfer sets D 2 . Equating the gradient of this expected value to zero to look for the stationary convergence point, we thus see sigmoid(γ) on both sides of the equation, and we obtain convergence when the new value of sigmoid(γ) is consistent with the old value, as clarified in this proposition.</p><p>Proposition 3 Stochastic gradient descent (with appropriately decreasing learning rate) on E D2 [R] with steps from ∂R ∂γ converges towards</p><formula xml:id="formula_6">sigmoid(γ) = 1 if E D2 [log L A→B ] &gt; E D2 [log L B→A ]</formula><p>, or σ(γ) = 0 otherwise. The proof is given in Section E of the Appendix, and shows that optimizing γ will end up picking the correct hypothesis, i.e., the one that has the smallest regret (or fastest convergence), measured as the accumulated log-likelihood as adaptation proceeds on the transfer distributions sampled from the distribution D 2 , which we can think of like a distribution over tasks, in meta-learning. This analogy with meta-learning also appears in our gradient-based adaptation procedure, which is linked to existing methods like the first-order approximation of MAML <ref type="bibr" target="#b7">(Finn et al., 2017)</ref>, and its related algorithms <ref type="bibr" target="#b18">(Nichol et al., 2018)</ref>. Algorithm 1 (Appendix C) illustrates the general pseudo-code for the proposed meta-learning framework.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3.1">Experimental Results</head><p>To illustrate the convergence result from Proposition 3, we experiment with learning the structural parameter γ in a bivariate model, with discrete random variables, each taking N = 10 and N = 100 possible values. In this experiment, we assume that the underlying causal model (unknown to the algorithm) is fixed to A → B, so that we want the structural parameter to eventually converge to σ(γ) = 1. The details of the experimental setup can be found in Appendix G.1.  In <ref type="figure" target="#fig_2">Figure 2</ref>, we show the evolution of σ(γ) (which is the model's belief of A → B being the correct causal model) as the number of episodes increases. Starting from an equal belief for both A → B and B → A to occur (σ(γ) = 0.5), the structural parameter converges to σ(γ) = 1 within 500 episodes.</p><p>This observation is consistent across a range of domains, including models with multimodal or multivariate continuous variables, and different parametrizations of the models. In Appendix G.2, we present results for two discrete variables but using MLPs to parametrize the conditional distributions, and where there are more causal hypotheses: we consider one binary choice for each directed edge in the graph, to decide whether one variable is a direct causal parent or not. <ref type="figure" target="#fig_10">Figure 3</ref> shows that the correct causal graph is quickly recovered. To estimate the gradient, we use a generalization of the regret loss (introduced above, Equation <ref type="formula" target="#formula_1">2</ref> Figure 3: Cross entropy between the ground-truth SCM structure and the learned SCM structure. Each MLP is trained to predict the conditional distribution associated with each discrete variable with N categories (10 and 100 in this case), given its parents. Between 50 and 100 meta-examples are sufficient to recover the causal structure.</p><p>In Appendix G.3, we consider the case of continuous scalar multimodal variables. The ground truth joint distribution is obtained by making the effect B a non-linear function f (A) of cause A, where f is a randomly generated spline. <ref type="figure">Figure G</ref>.1 shows an example of a resulting joint distribution. We model the conditionals with mixture density networks <ref type="bibr" target="#b4">(Bishop, 1994)</ref> and the marginals by a Gaussian mixture. We obtain results that are similar to the discrete case, with the correct causal interpretation being recovered quickly, as illustrated in <ref type="figure">Figure G</ref>.2.</p><p>We also show in Appendix G.4 results on models with two continuous random variables, each being distributed as a multivariate Gaussian, with N = 10 dimensions. Similar to the experiment with discrete random variables, the same argument about parameter counting mentioned in Section 2.2.1 holds here. Again, we obtain results consistent with the previous examples, where the structural parameter γ converges to 1, effectively recovering the correct causal model A → B.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.">Representation Learning</head><p>So far, we have assumed that the system has unrestricted access to the true underlying causal variables, A and B. However in many realistic scenarios for learning agents, the observations available to the learner might not be instances of the true causal variables but sensory-level data instead, like pixels and sounds. If this is the case, our working assumption -that the correct causal graph will be sparsely connected, made of independent components, and affected sparsely by distributional shifts -can not be expected to hold true in general in the space of observed variables. To tackle this, we propose to follow the deep learning objective of disentangling the underlying causal variables <ref type="bibr" target="#b3">(Bengio et al., 2013)</ref>, and learn a representation in which these properties hold. In the simplest form of this setting, the learner must map its raw observations to a hidden representation space H via an encoder E. The encoder is trained such that the hidden space H helps to optimize the meta-transfer objective described above, i.e., we consider the encoder, along with γ, as part of the set of structural or meta-parameters to be optimized with respect to the meta-transfer objective.</p><p>To study this simplified setting, we consider that our raw observations (X, Y ) originate from the true causal variables (A, B) via the action of a ground truth decoder D (or generator network) that the learner is not aware of but is implicitly trying to invert, as illustrated in <ref type="figure" target="#fig_4">Figure 4</ref>. The variables A, B, X and Y are assumed to be scalars, and we first consider D be a rotation matrix such that:</p><formula xml:id="formula_7">X Y = R(θ D ) A B<label>(5)</label></formula><p>The encoder is set to another rotation matrix, one that maps the observations X, Y to the hidden representation U, V as follows:</p><formula xml:id="formula_8">U V = R(θ E ) X Y<label>(6)</label></formula><p>The causal modules are now to be trained on the variables U and V in the same way as detailed in Section 2, as if they were observed directly. Indeed, if the encoder is valid one would obtain either (U, V ) = (A, B) or (U, V ) = (B, A) up to a negative sign, but we say in that case and without loss of generality that (U, V ) recovered (A, B), corresponding to the solution θ E = −θ D . In this case, the model U → V is causal and should therefore have an advantage over the anticausal model V → U , as far as adaptation speed on the transfer distribution is concerned. However, if the encoder is not valid, one would obtain superpositions of the form:</p><formula xml:id="formula_9">U = cos(θ)A − sin(θ)B (7) V = sin(θ)A + cos(θ)B<label>(8)</label></formula><p>where</p><formula xml:id="formula_10">θ = θ E + θ D .</formula><p>In the extremum where θ = π , it is clear that the model U → V will not have an advantage over the model V → U in terms of regret on the transfer distribution. However, the question we are interested in is whether it is possible to learn the encoder θ E . We verify this experimentally using Algorithm 1, but where the meta-parameters are now both γ (choosing between cause and effect which is which) and the parameters of the encoder (here the angle of a rotation matrix). The details of that experiment are provided in Appendix H, which illustrates -see <ref type="figure">Figure 5</ref> -how the proposed objective can disentangle (here in a very simple setting) the ground truth variables (up to permutation). The encoder R(θ E ) must be learned to undo the action of the (unknown) decoder and thereby recover the true causal variables.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.">Related Work</head><p>Although this paper focuses on the causal graph, the proposed objective is motivated by the more general question of discovering the underlying causal variables (and their dependencies) that explain the environment of a learner and make it possible for that learner to plan appropriately. The discovery of underlying explanatory variables has come under different names, in particular the notion of disentangling underlying variables <ref type="bibr" target="#b3">(Bengio et al., 2013)</ref>. As stated already by <ref type="bibr" target="#b3">Bengio et al. (2013)</ref> and clearly demonstrated by <ref type="bibr" target="#b16">Locatello et al. (2018)</ref>, assumptions, priors or biases are necessary to identify the underlying explanatory Solution 1 ( + 4 ) Solution 2 ( 4 ) <ref type="figure">Figure 5</ref>: Evolution of the encoder parameter θ E as training progresses. We set the parameter θ D of the implicit decoder to − π 4 : this corresponds to two valid solutions for the encoder, namely + π 4 and − π 4 . For the former, we obtain θ = 0 corresponding to the correct causal graph U → V ; and for the latter, θ = π 2 , corresponding to the correct causal graph V → U . The encoder parameter θ E is trained jointly with the structural parameter, and we find that it converges to one of the two valid solutions. Further details and the corresponding evolution of the structural parameter can be found in Appendix H.</p><p>variables. The latter paper <ref type="bibr" target="#b16">(Locatello et al., 2018</ref>) also reviews and evaluates recent work on disentangling, and discusses different metrics that have been proposed. An extreme view of disentangling is that the explanatory variables should be marginally independent, and many deep generative models <ref type="bibr" target="#b9">(Goodfellow et al., 2016)</ref> and independent component analysis models <ref type="bibr" target="#b11">(Hyvärinen et al., 2001;</ref><ref type="bibr" target="#b12">Hyvärinen et al., 2018)</ref> are built on this assumption. However, the kinds of high-level variables that we manipulate with natural language are not marginally independent: they are related to each other through statements that are usually expressed in sentences (e.g., a classical symbolic AI fact or rule), involving only a few concepts at a time. This kind of assumption has been proposed to help discover such linguistically relevant high-level representations from raw observations, such as the consciousness prior <ref type="bibr" target="#b2">(Bengio, 2017)</ref>, with the idea that humans focus at any particular time on just a few concepts that are present to our consciousness. The work presented here could provide an interesting meta-learning objective to help learn such encoders as well as figure out how the resulting variables are related to each other. In that case, one should distinguish two important assumptions: the first one is that the causal graph is sparse (has few edges, as in the consciousness prior <ref type="bibr" target="#b2">(Bengio, 2017)</ref> and in some methods to learn Bayes net structure, e.g. <ref type="bibr" target="#b23">(Schmidt et al., 2007)</ref>); and the second one is that it changes sparsely due to interventions (which is the focus of this work).</p><p>Approaches for Bayesian network structure learning based on discrete search over model structures and simulated annealing are reviewed in <ref type="bibr" target="#b10">Heckerman et al. (1995)</ref>. There, it has been common to use Minimum Description Length (MDL) principles to score and search over models <ref type="bibr">Lam and Bacchus (1993)</ref>; <ref type="bibr" target="#b8">Friedman and Goldszmidt (1998)</ref>, or the Bayesian Information Criterion (BIC) to search for models with high relative posterior probability <ref type="bibr" target="#b10">Heckerman et al. (1995)</ref>. Prior work such as <ref type="bibr" target="#b10">Heckerman et al. (1995)</ref> has also relied upon purely observational data, without the possibility of interventions and therefore focused on learning likelihood or hypothesis equivalence classes for network structures. Since then, numerous methods have also been devised to infer the causal direction from purely observational data <ref type="bibr" target="#b21">(Peters et al., 2017)</ref>, based on specific, generally parametric assumptions, on the underlying causal graph. Pearl's seminal work on do-calculus <ref type="bibr" target="#b20">Pearl (1995</ref><ref type="bibr" target="#b20">Pearl ( , 2009</ref>; <ref type="bibr" target="#b1">Bareinboim and Pearl (2016)</ref> lays a foundation for expressing the impact of interventions on probabilistic graphical models -we use it in our work. In contrast, here we are proposing a meta-learning objective function for learning causal structure, not requiring any specific constraints on causal graph structure, only on the sparsity of the changes in distribution in the correct causal graph parametrization.</p><p>Our work is also related to other recent advances in causation, domain adaptation and transfer learning. <ref type="bibr" target="#b17">Magliacane et al. (2018)</ref> have sought to identify a subset of features that lead to the best predictions for a variable of interest in a source domain such that the conditional distribution of the variable of interest given these features is the same in the target domain. <ref type="bibr" target="#b13">Johansson et al. (2016)</ref> examine counterfactual inference and formulate it as a domain adaptation problem. <ref type="bibr" target="#b25">Shalit et al. (2017)</ref> propose a technique called counterfactual regression for estimating individual treatment effects from observational data. Rojas-Carulla et al. <ref type="formula">2018</ref>propose a method to find an optimal subset that makes the target independent from the selection variables. To do so, they make the assumption that if the conditional distribution of the target given some subset is invariant across different source domains, then this conditional distribution must also be the same in the target domain. <ref type="bibr" target="#b19">Parascandolo et al. (2017)</ref> propose an algorithm to recover a set of independent causal mechanisms by establishing competition between mechanisms, hence driving specialization. <ref type="bibr" target="#b0">Alet et al. (2018)</ref> proposed a meta learing algorithm to recover a set of specialized modules, but did not establish any connections to causal mechanisms. More recently, <ref type="bibr" target="#b5">Dasgupta et al. (2019)</ref> adopted a meta-learning approach to draw causal inferences from purely observational data.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.">Conclusion and Future Work</head><p>We have established in very simple bivariate settings that the rate at which a learner adapts to sparse changes in the distribution of observed data can be exploited to select or optimize causal structure and disentangle the causal variables. This relies on the assumption that with the correct causal structure, those distributional changes are localized and sparse. We have demonstrated these ideas through theoretical results as well as experimental validation. See https://github.com/authors-1901-10912/ A-Meta-Transfer-Objective-For-Learning-To-Disentangle-Causal-Mechanisms for source code of the experiments.</p><p>This work is only a first step in the direction of optimizing causal structure based on the speed of adaptation to modified distributions. On the experimental side, many settings other than those studied here should be considered, with different kinds of parametrizations, richer and larger causal graphs, different kinds of optimization procedures, etc. Also, much more needs to be done in exploring how the proposed ideas can be used to learn good representations in which the causal variables are disentangled, since we have only experimented at this point with the simplest possible encoder with a single degree of freedom. Scaling up these ideas would permit their application towards improving the way in which learning agents deal with non-stationarities, and thus improving sample complexity and robustness of learning agents. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Appendix A. Results on Non-Identifiability of Causal Structure</head><p>We show here that the maximum likelihood estimation of both models specified in Equation <ref type="formula" target="#formula_0">1</ref>yields the same estimated distribution over A and B, i.e., the joint likelihood on the training distribution is not sufficient to distinguish the A → B and B → A causal models, in the non-parametric case (no assumption at all on the family of distributions). Let</p><formula xml:id="formula_11">θ i = P A→B (A = i) θ j|i = P A→B (B = j | A = i) η j = P B→A (B = j) η i|j = P B→A (A = i | B = j).</formula><p>We now state the maximum likelihood estimators for each models:</p><formula xml:id="formula_12">θ i = n i /nθ j|i = n ij /n î η j = n j /nη i|j = n ij /n j (9)</formula><p>where n is the total number of observations, n i the number of times we observed A = i, n j the number of times we observed B = j and n ij the number of times we observed A = i and B = j jointly. We can now compute the likelihood for each model:P</p><formula xml:id="formula_13">A→B (A, B) =θ iθj|i = n ij /n P B→A (A, B) =η jηi|j = n ij /n<label>(10)</label></formula><p>which is what we intended to show. To illustrate this result, we also experiment with learning the modules for both models A → B and B → A with SGD. In <ref type="figure">Figure A.</ref>1, we show the difference in log-likelihoods between these two models, evaluated on training and test data sampled from the same distribution, during training. We can see that while the model A → B fits the data faster than the other model (corresponding to a positive difference in <ref type="figure" target="#fig_0">Figure A.1)</ref>, both models achieve the same log-likelihoods on both models at convergence. This shows that the two models are indistinguishable based on data sampled from the same distribution, even on test data.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Appendix B. Proof of the Zero-Gradient Proposition</head><p>Let us restate more formally and prove Proposition 1.</p><p>Proposition Consider conditional probability modules</p><formula xml:id="formula_14">P θi (V i |pa(i, V, B i ))</formula><p>where B ij = 1 indicates that V j is among the parents pa(i, V, B i ) of V i in a directed acyclic causal graph. Consider ground truth training distribution P 1 and transfer distribution P 2 over these variables, and ground truth causal structure B. The joint log-likelihood L(V ) for a sample V with respect to the module parameters θ decomposed into module parameters</p><formula xml:id="formula_15">θ i is L(V ) = i log P θi (V i |pa(i, V, B i )).</formula><p>If (a) a model has the correct causal structure B, and (b) it been trained perfectly on P 1 , leading to estimated parameters θ, and (c) the ground truth P 1 and P 2 only differ from each other only for some P</p><formula xml:id="formula_16">(V i |pa(i, V, B i )) for i ∈ C, then E V ∼P2 [ ∂L(V ) ∂θi ] = 0 for i / ∈ C.</formula><p>Proof Let V −i be the subset of V excluding V i . We can simplify the expected gradient as follows.</p><formula xml:id="formula_17">E V ∼P2 ∂L(V ) ∂θ i = V P 2 (V ) k ∂ ∂θ i log P θ k (V k |pa(k, V, B k )) = 1 i∈C V−i P 2 (V −i ) Vi P 2 (V i |pa(i, V, B i )) ∂ ∂θ i log P θi (V i |pa(i, V, B i )) + 1 i / ∈C V−i P 2 (V −i ) Vi P 1 (V i |pa(i, V, B i )) ∂ ∂θ i log P θi (V i |pa(i, V, B i ))<label>(11)</label></formula><p>where the second equality is obtained because θ i does not influence module k = i, and P 2 is the same P 1 for conditionals with i / ∈ C (assumption (c)). Now for the special case of i / ∈ C, we obtain</p><formula xml:id="formula_18">E V ∼P2 ∂L(V ) ∂θ i = V−i P 2 (V −i ) Vi P 1 (V i |pa(i, V, B i )) ∂ ∂θ i log P θi (V i |pa(i, V, B i )) = V−i P 2 (V −i ) Vi P θi (V i |pa(i, V, B i )) ∂ ∂θ i log P θi (V i |pa(i, V, B i )) = 0<label>(12)</label></formula><p>where the second equality arises from assumption (b), and the last line from zeroing the inner sum via the general identity</p><formula xml:id="formula_19">v p θ (v) ∂ ∂θ log p θ (v) = ∂ ∂θ v p θ (v) = ∂1 ∂θ = 0. T t=1 P (a t , b t |A → B, θ t ) = L A→B .</formula><p>Furthermore, this can be equivalently written as</p><formula xml:id="formula_20">∂R ∂γ = σ(γ) − σ(γ + ∆),<label>(14)</label></formula><p>where ∆ = log L A→B − log L B→A is the difference between the log-likelihoods of the two hypotheses on transfer data D 2 .</p><p>Proof First note that, using Bayes rule,</p><formula xml:id="formula_21">P (A → B | D 2 ) = P (D 2 | A → B)P (A → B) P (D 2 | A → B)P (A → B) + P (D 2 | B → A)P (B → A) = L A→B σ(γ) L A→B σ(γ) + L B→A (1 − σ(γ)) = σ(γ)L A→B M ,<label>(15)</label></formula><p>where</p><formula xml:id="formula_22">M = σ(γ)L A→B + (1 − σ(γ))L</formula><p>B→A is the online likelihood of the transfer data under the mixture, so that the regret is R = − log M . For the second line above, note that</p><formula xml:id="formula_23">P (D 2 |A → B) = T t=1 P (a t , b t |A → B, {(a s , b s )} t−1 s=1 ) = T t=1 P (a t , b t |A → B, θ t ) = L A→B (16)</formula><p>where θ t encapsulates the information about {(a s , b s )} t−1 s=1 ) (through some adaptation procedure). Since we only consider the two hypotheses A → B and B → A, we also have</p><formula xml:id="formula_24">P (B → A | D 2 ) = (1−σ(γ))L B→A M = 1 − P (A → B | D 2 ). Then ∂R ∂γ = − σ(γ)(1 − σ(γ))L A→B − σ(γ)(1 − σ(γ))L B→A M = σ(γ)P (B → A | D 2 ) − (1 − σ(γ))P (A → B | D 2 ) = σ(γ) + σ(γ)P (A → B | D 2 ) − P (A → B | D 2 ) − σ(γ)P (A → B | D 2 ) = σ(γ) − P (A → B | D 2 )<label>(17)</label></formula><p>which concludes the first part of the proof. Moreover, in order to prove the equivalent formulation in Equation <ref type="formula" target="#formula_20">14</ref>, it is sufficient to prove that P (A → B | D 2 ) = σ(γ + ∆). Using the logit function σ −1 (z) = log z 1−z , and the expression in Equation <ref type="formula" target="#formula_21">15</ref>, we have</p><formula xml:id="formula_25">σ −1 (P (A → B | D 2 )) = log σ(γ)L A→B M − σ(γ)L A→B = log σ(γ)L A→B (1 − σ(γ))L B→A = log σ(γ) 1 − σ(γ) = γ + log L A→B − log L B→A = ∆ = γ + ∆<label>(18)</label></formula><p>Appendix E. Proof of the Proposition on the Convergence Point of Gradient Descent on the Structural Parameter</p><p>We use the same notation as in the above proof and statement.</p><p>Proposition 3 Stochastic gradient descent (with appropriately decreasing learning rate) on</p><formula xml:id="formula_26">E D2 [R], with R = − log [sigmoid(γ)L A→B + (1 − sigmoid(γ))L B→A ]</formula><p>and with steps following ∂R ∂γ converges towards</p><formula xml:id="formula_27">sigmoid(γ) = 1 if E D2 [log L A→B ] &gt; E D2 [log L B→A ], or σ(γ) = 0 otherwise.</formula><p>Proof We are going to consider the fixed point of gradient descent when the gradient is zero, since we already know that SGD converges with an appropriately decreasing learning rate. Let us introduce some notation to simplify the algebra: p = sigmoid(γ), M = pL A→B + (1 − p)L B→A , so R = log M , and define Again, this can only be 0 if L A→B = M all the time, i.e., p = 1. We conclude that the solutions p ∈ (0, 1) are not possible because they would lead to inconsistent conclusions, which leaves only p = 0 or p = 1. When p = 0 we have E[R] = E[log L A→B ], and when p = 1 we have E[R] = E[log L B→A ]. Thus the minimum will be achieved at p = 1 when E D2 [log L A→B ] &gt; E D2 [log L B→A ], or p = 0 otherwise.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Appendix F. More Than Two Causal Hypotheses</head><p>In this section, we consider one approach to generalize to more than two causal structures. We consider m variables, corresponding to O(2 m 2 ) possible causal graphs, since each variable V j could be (or not) a direct cause of any variable V i , leading to m 2 binary decisions. Note that a causal graph can in principle have cycles (if time is not measured with sufficient precision), although having a directed acyclic graph allows a much simpler sampling procedure (ancestral sampling). In our experiments the ground truth graph will always be directed, to make sampling easier and faster, but the learning procedure will not directly assume that. Motivated by the mechanism independence assumption, we propose a heuristic to learn the causal graph in which we independently parametrize the binary probability p ij that V j is a parent (direct cause) of V i . As was the case for Section 2, we parametrize this Binomial distribution via binary edges B ij that specify the graph structure:</p><formula xml:id="formula_28">B ij ∼ Bernoulli(p ij ), P (B) = ij P (B ij ).<label>(24)</label></formula><p>where p ij = sigmoid(γ ij ). Let us define the parents of V i , given B, as the set of V j 's such that B ij = 1:</p><formula xml:id="formula_29">pa(i, V, B i ) = {V j | B ij = 1, j = i} (25)</formula><p>where B i is the bit vector with elements B ij (and B ii = 0 is ignored). Similarly, we could parametrize the causal graph with a structural causal model where some of the inputs (from variable j) of each function (for variable i) can be ignored with some probability p ij :</p><formula xml:id="formula_30">V i = f i (θ i , B i , V, N i )<label>(26)</label></formula><p>where N i is an independent noise source to generate V i and f i parametrizes the generator (as in a GAN), while not being allowed to use variable V j unless B ij = 1 (and of course not being allowed to use V i ). We can consider that f i is a kind of neural network similar to the denoising auto-encoders or with dropout on the input, where B i is a binary mask vector that prevents f i from using some of the V j 's (for which B ij = 0). The conditional likelihood</p><formula xml:id="formula_31">P Bi (V i = v ti | pa(i, v t , B i ))</formula><p>measures how well the model that uses the incoming edges B i for node i performs for example v t . We build a multiplicative (or exponentiated) form of regret by multiplying these likelihoods as θ t changes during an adaptation episode, for node i:</p><formula xml:id="formula_32">L Bi = t P Bi (V i = v ti | pa(i, v t , B i )).<label>(27)</label></formula><p>The overall exponentiated regret for the given graph structure B is L B = i L Bi . Similarly to the bivariate case, we want to consider a mixture over all the possible graph structures, but where each component must explain the whole adaptation sequence, thus we define as a loss for the generalized multi-variable case</p><formula xml:id="formula_33">R = − log E B [L B ]<label>(28)</label></formula><p>Note the expectation over the 2 m 2 possible values of B, which is intractable. However, we can still get an efficient stochastic gradient estimator, which can be computed separately for each node of the graph (with samples arising only out of B i , the incoming edges into V i ):</p><p>Proposition 4 The overall regret (Equation (28)) rewrites</p><formula xml:id="formula_34">R = − i log Bi P (B i )L Bi (29)</formula><p>and if we are willing to consider multiple samples of B in parallel, a biased but asymptotically unbiased (as the number K of these samples B <ref type="bibr">(k)</ref> increases to infinity) estimator of the gradient of the overall regret with respect to meta-parameters can be defined:</p><formula xml:id="formula_35">g ij = k (σ(γ ij ) − B (k) ij )L (k) Bi k L (k) Bi (30)</formula><p>where the <ref type="bibr">(k)</ref> index indicates the values obtained for the k-th draw of B.</p><p>Proof Recall that L B = i L Bi so we can rewrite the regress loss as follows:</p><formula xml:id="formula_36">R = − log E B [L B ] = − log B P (B)L B = − log B1 B2</formula><p>. . .</p><formula xml:id="formula_37">B M i P (B i )L Bi = − log i Bi P (B i )L Bi = − i log Bi P (B i )L Bi<label>(31)</label></formula><p>So the regret gradient on meta-parameters γ i of node i is</p><formula xml:id="formula_38">∂R ∂γ i = − Bi P (B i )L Bi ∂ log P (Bi) ∂γi Bi P (B i )L Bi = − E Bi [L Bi ∂ log P (Bi) ∂γi ] E Bi [L Bi ]<label>(32)</label></formula><p>Note that with the sigmoidal parametrization of P (B ij ),</p><formula xml:id="formula_39">log P (B ij ) = B ij log sigmoid(γ ij ) + (1 − B ij ) log(1 − sigmoid(γ ij ))</formula><p>as in the cross-entropy loss. Its gradient can similarly be simplified to</p><formula xml:id="formula_40">∂ log P (B ij ) ∂γ ij = B ij sigmoid(γ ij ) sigmoid(γ ij )(1 − sigmoid(γ ij )) − (1 − B ij ) (1 − sigmoid(γ ij )) sigmoid(γ ij )(1 − sigmoid(γ ij ))) = B ij − sigmoid(γ ij )<label>(33)</label></formula><p>A biased but asymptotically unbiased estimator of ∂R ∂γij is thus obtained by sampling K graphs (over which the means below are run):</p><formula xml:id="formula_41">g ij = k (σ(γ ij ) − B (k) ij ) L B (k) i k L B (k ) i (34)</formula><p>where index <ref type="bibr">(k)</ref> indicates the k-th draw of B, and we obtain a weighted sum of the individual binomial gradients weighted by the relative regret of each draw B</p><formula xml:id="formula_42">(k) i of B i , leading to Equation (30).</formula><p>This decomposition is good news because the loss is a sum of independent terms, one per node i, depending only of B i and and similarly g ij only depends on B i rather than the full graph structure. We use the estimator from Equation (30) in the general pseudo-code for meta-transfer learning of causal structure displayed in Algorithm 1.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Appendix G. Results on Learning which is Cause and which is Effect</head><p>In order to assess the performance of our meta-learning algorithm, we applied it on generated data from three different domains: discrete random variables, multimodal continuous random variables and multivariate gaussian-distributed variables. In this section, we describe the setups for all three experiments, along with additional results to complement the results described in the main text. Note that in all these experiments, we fix the structure of the ground-truth to be A → B, and only perform interventions on the cause A.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>G.1 Discrete variables and Two Causal Hypotheses</head><p>We consider a bivariate model, where both random variables are sampled from a categorical distribution. The underlying ground-truth model can be described as</p><formula xml:id="formula_43">A ∼ Categorical(π A ) B | A = a ∼ Categorical(π B|a ),<label>(35)</label></formula><p>with π A is a probability vector of size N , and π B|a is a probability vector of size N , which depends on the value of the variable A. In our experiment, each random variable can take one of N = 10 values. Since we are working with only two variables, the only two possible models are:</p><p>• Model A → B: P (A, B) = P (A)P (B | A)</p><p>• Model B → A: P (A, B) = P (B)P (A | B)</p><p>We build 4 different modules, corresponding to the model of each possible marginal and conditional distribution. These modules' definition and their corresponding parameters are shown in <ref type="table">Table G</ref>.1.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Distribution Module Parameters Dimension</head><p>Model A → B P (A) <ref type="table">Table G</ref>.1: Description of the 2 models, with the parametrization of each module, for a bivariate model with discrete random variables. Model A → B and Model B → A both have the same number of parameters N 2 + N .</p><formula xml:id="formula_44">P (x A = i ; θ A ) = [softmax(θ A )] i θ A N P (B | A) P (x B = j | x A = i ; θ B|A ) = [softmax(θ B|A (i))] j θ B|A N 2 Model B → A P (B) P (x B = j ; θ B ) = [softmax(θ B )] j θ B N P (A | B) P (x A = i | x B = j ; θ A|B ) = [softmax(θ A|B (j))] i θ A|B N</formula><p>In order to get a set of initial parameters, we first train all 4 modules on a training distribution. This training distribution corresponds to a fixed choice of π</p><p>(1)</p><p>A and π B|a (for all N possible values of a). Note that the superscript in π</p><p>(1)</p><p>A emphasizes the fact that this defines the distribution prior to intervention, with the mechanism P (B | A) being unchanged by the intervention. These probability vectors are sampled randomly from a uniform Dirichlet distribution</p><formula xml:id="formula_45">π (1) A ∼ Dirichlet(1 N ) π B|a ∼ Dirichlet(1 N ) ∀a ∈ [1, N ].<label>(36)</label></formula><p>Given this initial training distribution, we can sample a large dataset of training examples</p><formula xml:id="formula_46">{(a i , b i )} n i=1</formula><p>from the ground-truth model, using ancestral sampling.</p><formula xml:id="formula_47">a ∼ Categorical(π (1) A ) b ∼ Categorical(π B|a ).<label>(37)</label></formula><p>Using this large dataset from the training distribution, we can train all 4 modules using gradient descent, or any other advanced first-order optimizer, like RMSprop. The parameters θ A , θ B|A , θ B &amp; θ A|B of the different modules found after this initial training will be used as the initial parameters for the adaptation on a new transfer distribution.</p><p>Similar to the way we defined the training distribution, we can define a transfer distribution as a soft intervention on the random variable A. In this experiment, this accounts for changing the distribution of A, that is with a new probability vector π</p><p>(2)</p><p>A , also sampled randomly from a uniform Dirichlet distribution</p><formula xml:id="formula_48">π (2) A ∼ Dirichlet(1 N )<label>(38)</label></formula><p>To perform adaptation on the transfer distribution, we also sample a smaller dataset of transfer examples</p><formula xml:id="formula_49">D 2 = {(a i , b i } m i=1</formula><p>, with m n the size of the training set. In our experiment, we used m = 20 transfer examples. We also used ancestral sampling on this new transfer distribution to acquire samples, similar to Equation (37) (with π</p><formula xml:id="formula_50">(2) A instead of π (1) A ).</formula><p>Starting from the parameters estimated after the initial training on the training distribution, we perform a few steps of adaptation on the modules parameters θ A , θ B|A , θ B &amp; θ A|B using T steps of gradient descent based on the transfer dataset D 2 . The value of the likelihoods for both models is recorded as well, and computed as</p><formula xml:id="formula_51">L A→B = T t=1 P (a t | θ (t) A )P (b t | a t ; θ (t) B|A ) L B→A = T t=1 P (b t | θ (t) B )P (a t | b t ; θ (t) A|B ),<label>(39)</label></formula><p>where (a t , b t ) represents a mini-batch of examples from D 2 , and the superscript t on the parameters highlights the fact that these likelihoods are computed after t steps of adaptation. This product over t ensures that we monitor the progress of adaptation along the whole trajectory. In this experiment, we used T = 2 steps of gradient descent on mini-batch of size 10 for the adaptation. Finally, in order to update the structural parameter γ, we can use Proposition 2 to compute the gradient of the loss L with respect to γ:</p><formula xml:id="formula_52">R(γ) = − log[σ(γ)L A→B + (1 − σ(γ))L B→A ] (40) ∂R ∂γ = σ(γ + ∆) − σ(γ),<label>(41)</label></formula><p>where ∆ = log L A→B − log L B→A . The update of γ can be one step of gradient descent, or using any first-order optimizer like RMSprop. We perform multiple interventions over the course of meta-training by sampling multiple transfer distributions, and following the same steps of adaptation and update of the structural parameter γ.</p><p>In <ref type="figure" target="#fig_2">Figure 2</ref>, we report the evolution of the structural parameter γ (or rather, σ(γ)) as a function of the number of meta-training steps or, similarly, the number of different interventions made on the causal model. The model's belief P (A → B) = σ(γ) indeed converges to 1, proving that the algorithm was capable of recovering the correct causal direction A → B.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>G.2 Discrete Variables with MLP Parametrization</head><p>We consider a bivariate model similar to the ones defined above, where each random variable is sampled from a categorical distribution. Instead of expressing probabilities in a tabular form, we train M = 2 simple feed-foward neural networks (MLP), one per conditional variable. MLP i is the independent mechanism of causal variable i that determines the conditional probability of the N discrete choices for variable i, given its parents.</p><p>Each MLP receives M concatenated N -dimensional one-hot vectors, masked appropriately according to the chosen causal structure B, i.e., with the j-th input of the i-th MLP being multiplied by B ij . Each directed edge presence or absence is thus indicated by B ij , with B ij = 1 if variable j is a direct causal parent of variable i. The MLP maps the M N input units through one hidden layer that contains H = 4M hidden units and a ReLU non-linearity, and then maps the H hidden units to N output units and a softmax representing a predicted categorical distribution.</p><p>The causal structure belief is specified by an M × M matrix γ, with σ(γ ij ) the estimated probability that variable i is directly caused by variable j. The causal structure B ij is drawn from Ber(γ ij ), as per Algorithm 1. We generalize the estimator introduced for the 2-hypotheses case as per Appendix F, i.e., we use the gradient estimator in Equation 30.</p><p>To evaluate the correctness of the structure being learnt, we measure the cross entropy between the ground-truth SCM and the learned SCM. In <ref type="figure" target="#fig_10">Figure 3</ref> we show this cross-entropy over different episodes of training for bivariate discrete distributions with either 10 categories or 100 categories. Both models are first pretrained for 100 examples with fully connected edges before starting training on the transfer distributions.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>G.3 Continuous Multimodal Variables</head><p>Consider a family of joint distributions P µ (A, B) over the causal variables A and B sampled from the structural causal model (SCM):</p><formula xml:id="formula_53">A ∼ P µ (A) = N (µ, σ 2 = 4) B := f (A) + N B N B ∼ N (µ = 0, σ 2 = 1)<label>(42)</label></formula><p>where f is a randomly generated spline and N B is sampled i.i.d from the unit-normal distribution.</p><p>To obtain the spline, we sample the K points {x k } K k=1 uniformly spaced from the interval [−R A , R A ], and another K points {y k } K k=1 uniform randomly from the interval [−R B , R B ]. This yields K pairs {(x k , y k )} K k=1 , which make the knots of a second-order spline. We set K = 8, R A = R B = 8 for our experiments. In <ref type="figure">Figure G</ref>.1, we plot samples from one such SCM for the training distribution (µ = 0) and two transfer distributions (µ = ±4).  <ref type="figure">Figure G</ref>.1: Train (red) and transfer (green and blue) samples from an SCM generated with the procedure described in Equation (42). The green data-points are sampled from P µ=(−4) (A, B), whereas the blue data-points are samples from P µ=(+4) (A, B) and the red data points (training set) are from P µ=0 (A, B).</p><p>The conditionals P (B | A ; θ B|A ) and P (A | B ; θ A|B ) are parameterized as 2-layer Mixture Density Networks Bishop (1994) with 32 hidden units and 10 components. The marginals P (A | θ A ) and P (B | θ B ) are parameterized as Gaussian Mixture Models, also with 10 components. The training now follows as described below.</p><p>Similar to Appendix G.1, we first pre-train the modules corresponding to the conditionals and marginals on the training distribution. To that end, we select P µ=0 (A, B) as the training distribution, sample a (large) training dataset {(a i , b i )} n i=1 from it using ancestral sampling, and solve the following two problems independently until convergence:</p><formula xml:id="formula_54">max θ A ,θ B|A n i=1 log P (a i | θ A )P (b i | a i ; θ B|A ) (43) max θ B ,θ A|B n i=1 log P (b i | θ B )P (a i | b i ; θ A|B )<label>(44)</label></formula><p>The adaptation performance of A → B and B → A models can now be evaluated on transfer distributions. For a µ sampled uniformly in [−4, 4], we select P µ (A , B ) as the transfer distribution, and denote with (A , B ) samples from it. Both models are fine-tuned on P µ (A , B ) for T = 10 iterations (see Algorithm 1), and the area under the corresponding negative-log-likelihood curves becomes the regret:</p><formula xml:id="formula_55">R A→B = − T t=1 log P (B |A ; θ (t) A→B )P (A |θ (T ) A→B )<label>(45)</label></formula><p>and likewise for R B→A . In these experiments, the modules corresponding to the marginals (ie. GMM) are learned offline via Expectation Maximization, and we denote with P (A |θ (T )</p><p>A→B ) the trained model. These can now be used to define the following meta-objective for the structural meta-parameter γ:</p><formula xml:id="formula_56">R(γ) = log[σ(γ)e R A→B + (1 − σ(γ))e R B→A ]<label>(46)</label></formula><p>The structural regret R(γ) is now minimized with respect to γ for 200 iterations (updates of γ). <ref type="figure">Figure G</ref>.2 shows the evolution of σ(γ) as training progresses. This is expected, given that we expect the causal model to perform better on the transfer distributions, i.e. we expect R A→B &lt; R B→A in expection. Consequently, assigning a larger weight to R A→B optimizes the objective. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>G.4 Linear Gaussian Model</head><p>In this experiment, the two variables we consider are vectors (i.e. A ∈ R d and B ∈ R d ). The ground truth causal model is given by</p><formula xml:id="formula_57">A ∼ N (µ A , Σ A ) B := β 1 A + β 0 + N B N B ∼ N (0, Σ B )<label>(47)</label></formula><p>where µ A ∈ R d , β 0 ∈ R d and β 1 ∈ R d×d . Σ A and Σ B are d × d covariance matrices 2 . In our experiments, d = 100. Once again, we want to identify the correct causal direction between A and B. To do so, we consider two models: A → B and B → A. We parameterize both models symmetrically: </p><formula xml:id="formula_58">P</formula><p>Note that each covariance matrix is parameterized using the Cholesky decomposition. Unlike previous experiments, we are not conducting any pre-training on actual data. Instead, we fix the parameters of both models to their exact values according to the ground truth parameters introduced in Equation 47. For model A → B, this can be done trivially. For the second model, we can compute its exact parameters analytically.</p><p>Once the exact parameters are set, both models are equivalent in the sense that P A→B (A, B) = P B→A (A, B) ∀A, B.</p><p>Each meta-learning episode starts by initializing the parameters of both models to the values identified during the pre-training. Afterward, a transfer distribution is sampled (i.e. µ A ∼ N (0, I)). Then, both models are trained on samples from this distribution, for 10 iterations only. During this adaptation, the log-likelihoods of both models are accumulated in order to compute L A→B and L B→A . At this stage, we compute the meta objective estimate R = − log [sigmoid(γ)L A→B + (1 − sigmoid(γ))L B→A ], compute its gradient w.r.t. γ and update γ. <ref type="figure">Figure G</ref>.3 shows that, after 200 episodes, σ(γ) converges to 1, indicating the success of the method on this particular task. </p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Figure 1 :</head><label>1</label><figDesc>Adaptation to the transfer distribution, as more transfer distribution examples are seen by the learner (horizontal axis), in terms of the log-likelihood on the transfer distribution (on a large test set from the transfer distribution, tested after each update of the parameters).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Figure 2 :</head><label>2</label><figDesc>Evolution of model's belief p(A → B) = σ(γ) on a bivariate model, with discrete random variables (N = 10 &amp; N = 100). The horizontal axis represents the number of episodes (i.e., meta-examples) seen during meta-training, which corresponds to the number of SGD updates of the structural parameter γ.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Figure 4 :</head><label>4</label><figDesc>The complete computational graph. The variables (A, B) are assumed to originate from the true underlying causal distribution, but the observations available to the learner are (X, Y ) samples, which are obtained from (A, B) via the action of an implicit (a priori unknown) decoder R(θ D ).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>Figure A. 1 :</head><label>1</label><figDesc>Difference in log-likelihoods between the two models A → B and B → A on training and test data from the same distribution on discrete data, for different values of N , the number of discrete values per variable. Once fully trained, both models become indistinguishable from their log-likelihoods only, even on test data. The solid curves represent the median values over different runs, and the shaded areas their 25-75 quantiles.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head>Figure G. 2 :</head><label>2</label><figDesc>Evolution of the sigmoid of structural meta-parameter σ(γ) with training iterations. It is indeed expected to increase if A → B is the true causal graph (see Equation(46)).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_9"><head></head><label></label><figDesc>A→B (A) = N (A;μ A ,Σ A ) P A→B (B | A = a) = N (B;Ŵ 1 a +Ŵ 0 ,Σ A→B ) P B→A (B) = N (B;μ B ,Σ B ) P B→A (A | B = b) = N (B;V 1 b +V 0 ,Σ B→A )</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_10"><head>Figure G. 3 :</head><label>3</label><figDesc>Convergence of the causal belief (to the correct answer) as a function of the number of metalearning episodes, for the linear Gaussian experiments.</figDesc></figure>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="1">. One can see log L A→B as a score attributed to graph A → B, analogously for log L B→A . The gradient is then pushing toward the graph with the highest score.</note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="2">. Ground truth parameters µ A , β 1 and β 0 are sampled from a Gaussian distribution, while Σ A and Σ B are sampled from an inverse Wishart distribution.</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgements</head><p>We would like to acknowledge support for this project from NSERC, CIFAR and Canada Research Chairs, as well as the feedback from Rémi Le Priol, Isabelle Lacroix, Alexandre Piché, and Akram Erraqabi. AG would like to thank Sergey Levine, Chelsea Finn, Michael Chang, Abhishek Gupta for useful discussions.</p></div>
			</div>

			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Appendix C. Pseudo-Code</head><p>Draw initial meta-parameters of learner Draw a training set from training distr. Set causal structure to include all edges Initialize learner parameters for this model Pre-train the learner's parameters on the training set Repeat J times Draw a transfer distr. Draw causal structure(s) according to meta-parameters Repeat T times Sample minibatch from transfer distribution Accumulate online log-likelihood of minibatch Update the model parameters accordingly</p><p>Compute the meta-parameters gradient estimator Update the meta-parameters by SGD Optionally reset parameters to pre-training value </p><p>with respect to the structural parameter γ (where σ(γ) = P (A → B)) is given by</p><p>where D 2 is the transfer data, and</p><p>is the posterior probability of the hypothesis A → B (when the alternative is B → A), defined by applying Bayes rule to P (D 2 | A → B) =</p><p>, and</p><p>Framing the stationary point in terms of p rather than γ gives us the inequality constraints −p ≤ 0 and p − 1 ≤ 0 and no equality constraint. Applying the KKT conditions with constraint functions −p and p − 1 gives us</p><p>We already see from the last two equations that if p ∈ (0, 1) (i.e. excluding 0 and 1), we must have µ 1 = µ 2 = 0, i.e., E[ ∂R ∂p ] = 0 (with drop the D 2 subscript on E when it is clear from context). Let us study that case first and show that it leads to an inconsistent set of equations (thus forcing the solution to be either p = 0 or p = 1). Let us rewrite the gradient to highlight p in it:</p><p>The KKT conditions with the above two inequality constraints for 0 ≤ p ≤ 1 give</p><p>If we consider the solutions p ∈ (0, 1) (i.e., µ 1 = µ 2 = 0) we now show that we get a contradiction. First note that to satisfy the above equation with µ 1 = µ 2 = 0 means that either p = 0 or p = 1 (which is inconsistent with the assumption that p ∈ (0, 1)) or that E L A→B −L B→A M = 0. Let us consider that equation, and since p = 0 and p = 1 we can either multiply by p or by 1 − p on both sides. Assuming p = 0 and multiplying by</p><p>For this equation to be satisfied, we need L B→A = M all the time, since L B→A ≤ M by construction. This would however correspond to p = 0. Similarly, assuming p = 1 we can multiply the stationarity equation by − p and get</p><p>Appendix H. Results on Learning the Correct Encoder</p><p>The causal variables (A, B) are sampled from the distribution described in Eqn 42, and are mapped to observations (X, Y ) ∼ P µ (X, Y ) via a hidden (and a priori unknown) decoder D = R(θ D ), where R is a rotation matrix. The observations are then mapped to the hidden state (U, V ) ∼ P µ (U, V ) via the encoder E = R(θ E ). The computational graph is depicted in <ref type="figure">Figure 4</ref>.</p><p>Analogous to Equation 46 in Appendix G.3, we now define the regret over the variables (U, V ) instead of (A, B):</p><p>where the dependence on θ E is implicit in (U, V ). In every meta-training iteration, the U → V and V → U models are trained on the training distribution P µ=0 (U, V ) for T = 20 iterations. Subsequently, the regrets R U →V and R V →U are obtained by a process identical to that described in Equation 45 of Appendix G.3 (albeit with variables (U, V ) and T = 5). Finally, the gradients of R(γ, θ E ) are evaluated and the metaparameters γ and θ E are updated. This process is repeated for 1000 meta-iterations, and <ref type="figure">Figure 5</ref> shows the evolution of θ E as training progresses (where θ D has been set to − π 4 ). Further, <ref type="figure">Figure H</ref>.1 shows the corresponding evolution of the structural parameter γ.  <ref type="figure">Figure H</ref>.1: Evolution of the structural parameter γ as training progresses with the encoder. The corresponding evolution of the encoder parameter θ E is shown in <ref type="figure">Figure 5</ref>. Observe that the system converges to θ = 0, implying that the correct causal direction is U → V and the parameter γ should increase with meta-training iterations.</p></div>			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Ferran</forename><surname>Alet</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Tomás</forename><surname>Lozano-Pérez</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Leslie</forename><forename type="middle">P</forename><surname>Kaelbling</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1806.10166</idno>
		<imprint>
			<date type="published" when="2018" />
		</imprint>
	</monogr>
	<note type="report_type">Modular meta-learning. arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Causal inference and the data-fusion problem</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Elias</forename><surname>Bareinboim</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Judea</forename><surname>Pearl</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the National Academy of Sciences</title>
		<meeting>the National Academy of Sciences</meeting>
		<imprint>
			<date type="published" when="2016" />
			<biblScope unit="volume">113</biblScope>
			<biblScope unit="page" from="7345" to="7352" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<monogr>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Yoshua</forename><surname>Bengio</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1709.08568</idno>
		<title level="m">The consciousness prior</title>
		<imprint>
			<date type="published" when="2017" />
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Representation learning: A review and new perspectives</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Yoshua</forename><surname>Bengio</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Aaron</forename><surname>Courville</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Pascal</forename><surname>Vincent</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Pattern Analysis and Machine Intelligence (PAMI)</title>
		<imprint>
			<biblScope unit="volume">35</biblScope>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page" from="1798" to="1828" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<monogr>
		<title level="m" type="main">Mixture density networks</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Christopher</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Bishop</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1994" />
			<publisher>Citeseer</publisher>
		</imprint>
	</monogr>
	<note type="report_type">Technical report</note>
</biblStruct>

<biblStruct xml:id="b5">
	<monogr>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Ishita</forename><surname>Dasgupta</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jane</forename><surname>Wang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Silvia</forename><surname>Chiappa</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jovana</forename><surname>Mitrovic</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Pedro</forename><surname>Ortega</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">David</forename><surname>Raposo</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Edward</forename><surname>Hughes</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Peter</forename><surname>Battaglia</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Matthew</forename><surname>Botvinick</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Zeb</forename><surname>Kurth-Nelson</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1901.08162</idno>
		<title level="m">Causal Reasoning from Meta-reinforcement Learning</title>
		<imprint>
			<date type="published" when="2019" />
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">A general lower bound on the number of examples needed for learning</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Andrzej</forename><surname>Ehrenfeucht</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">David</forename><surname>Haussler</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Michael</forename><surname>Kearns</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Leslie</forename><surname>Valiant</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Information and Computation</title>
		<imprint>
			<biblScope unit="volume">82</biblScope>
			<biblScope unit="issue">3</biblScope>
			<date type="published" when="1989" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Model-Agnostic Meta-Learning for Fast Adaptation of Deep Networks</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Chelsea</forename><surname>Finn</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Pieter</forename><surname>Abbeel</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Sergey</forename><surname>Levine</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">International Conference on Machine Learning (ICML)</title>
		<imprint>
			<date type="published" when="2017" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">Learning bayesian networks with local structure</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Nir</forename><surname>Friedman</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Moises</forename><surname>Goldszmidt</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Learning in graphical models</title>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="1998" />
			<biblScope unit="page" from="421" to="459" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<monogr>
		<title level="m" type="main">Deep Learning</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Ian</forename><forename type="middle">J</forename><surname>Goodfellow</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Yoshua</forename><surname>Bengio</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Aaron</forename><surname>Courville</surname></persName>
		</author>
		<ptr target="http://deeplearningbook.org" />
		<imprint>
			<date type="published" when="2016" />
			<publisher>MIT Press</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">Learning bayesian networks: The combination of knowledge and statistical data</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">David</forename><surname>Heckerman</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Dan</forename><surname>Geiger</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">David</forename><forename type="middle">M</forename><surname>Chickering</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Machine learning</title>
		<imprint>
			<biblScope unit="volume">20</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="197" to="243" />
			<date type="published" when="1995" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<monogr>
		<title level="m" type="main">Independent Component Analysis</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Aapo</forename><surname>Hyvärinen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Juha</forename><surname>Karhunen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Erkki</forename><surname>Oja</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2001-05" />
			<publisher>Wiley-Interscience</publisher>
			<biblScope unit="volume">047140540</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<monogr>
		<title level="m" type="main">Nonlinear ica using auxiliary variables and generalized contrastive learning</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Aapo</forename><surname>Hyvärinen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Hiroaki</forename><surname>Sasaki</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Richard</forename><forename type="middle">E</forename><surname>Turner</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1805.08651</idno>
		<imprint>
			<date type="published" when="2018" />
			<publisher>CoRR</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Learning representations for counterfactual inference</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Fredrik</forename><surname>Johansson</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Uri</forename><surname>Shalit</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">David</forename><surname>Sontag</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">International Conference on Machine Learning</title>
		<imprint>
			<date type="published" when="2016" />
			<biblScope unit="page" from="3020" to="3029" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<monogr>
		<title level="m" type="main">Probabilistic Graphical Models: Principles and Techniques</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Daphne</forename><surname>Koller</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Nir</forename><surname>Friedman</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2009" />
			<publisher>MIT press</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Using causal information and local measures to learn bayesian networks</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Wai</forename><surname>Lam</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Fahiem</forename><surname>Bacchus</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the Ninth international conference on Uncertainty in artificial intelligence</title>
		<meeting>the Ninth international conference on Uncertainty in artificial intelligence</meeting>
		<imprint>
			<biblScope unit="page" from="243" to="250" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<monogr>
		<title level="m" type="main">Challenging common assumptions in the unsupervised learning of disentangled representations</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Francesco</forename><surname>Locatello</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Stefan</forename><surname>Bauer</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Mario</forename><surname>Lucic</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Sylvain</forename><surname>Gelly</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Bernhard</forename><surname>Schölkopf</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Olivier</forename><surname>Bachem</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1811.12359</idno>
		<imprint>
			<date type="published" when="2018" />
			<publisher>CoRR</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">Domain adaptation by using causal inference to predict invariant conditional distributions</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Sara</forename><surname>Magliacane</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Tom</forename><surname>Thijs Van Ommen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Stephan</forename><surname>Claassen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Philip</forename><surname>Bongers</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Joris M</forename><surname>Versteeg</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Mooij</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Advances in Neural Information Processing Systems</title>
		<imprint>
			<date type="published" when="2018" />
			<biblScope unit="page" from="10869" to="10879" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Alex</forename><surname>Nichol</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Joshua</forename><surname>Achiam</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">John</forename><surname>Schulman</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1803.02999</idno>
	</analytic>
	<monogr>
		<title level="j">On First-Order Meta-Learning Algorithms</title>
		<imprint>
			<date type="published" when="2018" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<monogr>
		<title level="m" type="main">Learning independent causal mechanisms</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Giambattista</forename><surname>Parascandolo</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Niki</forename><surname>Kilbertus</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Mateo</forename><surname>Rojas-Carulla</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Bernhard</forename><surname>Schölkopf</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1712.00961</idno>
		<imprint>
			<date type="published" when="2017" />
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b20">
	<analytic>
		<title level="a" type="main">Causal diagrams for empirical research</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Judea</forename><surname>Pearl</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Biometrika</title>
		<imprint>
			<biblScope unit="volume">82</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="669" to="688" />
			<date type="published" when="1995" />
			<publisher>Judea Pearl. Causality. Cambridge university press</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<monogr>
		<title level="m" type="main">Elements of causal inference: foundations and learning algorithms</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jonas</forename><surname>Peters</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Dominik</forename><surname>Janzing</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Bernhard</forename><surname>Schölkopf</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2017" />
			<publisher>MIT press</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<analytic>
		<title level="a" type="main">Invariant models for causal transfer learning</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Mateo</forename><surname>Rojas-Carulla</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Bernhard</forename><surname>Schölkopf</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Richard</forename><surname>Turner</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jonas</forename><surname>Peters</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">The Journal of Machine Learning Research</title>
		<imprint>
			<biblScope unit="volume">19</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="1309" to="1342" />
			<date type="published" when="2018" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b23">
	<analytic>
		<title level="a" type="main">Learning graphical model structure using l1-regularization paths</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><surname>Mark</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Alexandru</forename><surname>Schmidt</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Kevin</forename><forename type="middle">P</forename><surname>Niculescu-Mizil</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Murphy</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">AAAI</title>
		<imprint>
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b24">
	<monogr>
		<title level="m" type="main">Understanding Machine Learning -from Theory to Algorithms</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Shai</forename><surname>Shalev</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">-</forename><surname>Shwartz</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Shai</forename><surname>Ben-David</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2014" />
			<publisher>Cambridge University Press</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b25">
	<analytic>
		<title level="a" type="main">Estimating individual treatment effect: generalization bounds and algorithms</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Uri</forename><surname>Shalit</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Fredrik</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">David</forename><surname>Johansson</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Sontag</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the 34th International Conference on Machine Learning</title>
		<meeting>the 34th International Conference on Machine Learning</meeting>
		<imprint>
			<date type="published" when="2017" />
			<biblScope unit="volume">70</biblScope>
			<biblScope unit="page" from="3076" to="3085" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b26">
	<analytic>
		<title level="a" type="main">On the uniform convergence of relative frequencies of events to their probabilities</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">V</forename><forename type="middle">N</forename><surname>Vapnik</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><forename type="middle">Y</forename><surname>Chervonenkis</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Theory of Probability and its Applications</title>
		<imprint>
			<date type="published" when="1971" />
			<biblScope unit="volume">16</biblScope>
			<biblScope unit="page" from="264" to="280" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
